<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name='apple-mobile-web-app-capable' content='yes' />
<meta name='viewport' content='initial-scale=1.0, maximum-scale=1.0, user-scalable=0, width=device-width, height=device-height' />
<meta name='apple-mobile-web-app-status-bar-style' content='black-translucent' />
<title>FULL</title>
<link rel="canonical" href="https://williac0374.github.io/Full/" />
<link rel="manifest" href="/Full/manifest.webmanifest">
<style>
/* CSS to disable scrolling and set fullscreen */
html, body {
  margin: 0;
  padding: 0;
  height: 100vh;
  width: 100vw;
  /* Prevents scrolling */
  overflow: hidden;
  box-sizing: border-box;
  background-color: green;
  display: flex;
  justify-content: center;
  align-items: center;
  font-family: Arial, sans-serif;
  text-align: center;
}
canvas {
  // border: 2px solid #000;
  background-color: white;
  margin: 0;
  padding: 0;
  
}
/* Styles that apply only to devices without a hover capability (i.e., touch-only devices like most phones/tablets) */
@media (hover: none) and (pointer: coarse) {
  /* Mobile-specific styles for touch interaction */
  canvas {
    height: 100vh;
    width: 100vw;
  }
}
</style>
</head>
<body>
<canvas id="canvas" width="320" height="675"></canvas>

<script>
/* * 2. JavaScript Solution: Intercepts 'touchmove' events to block the pinch-zoom gesture.
* This is often the most reliable method for recent versions of Chrome on Android.
*/

document.addEventListener('touchmove', function(event) {
  // Check if there are more than one touch points (a pinch gesture)
  if (event.touches.length > 1) {
    // Prevent the default browser behavior (which includes zooming)
    event.preventDefault();
  }
}, { passive: false }); // Use { passive: false } to ensure event.preventDefault() works
  
  // Optional: To block double-tap to zoom, though less common now:
  var lastTouchEnd = 0;
  document.addEventListener('touchend', function (event) {
    var now = (new Date()).getTime();
    // Check for double tap (two touchend events close together)
    if (now - lastTouchEnd <= 300) {
      event.preventDefault();
    }
    lastTouchEnd = now;
  }, false);
  //-----------------------------
  //TARGET MACROS
  var KCALS = 2400
  var PROTEIN = 200
  var CHOLESTEROL = 300
  var FIBER = 30
  //----------------------------
  var kcal=1500
  var protien = 199
  var cholesterol = 125
  var fiber = 15
var left= {x:0, y:600, w:120, h:75};
var center= {x:120, y:600, w:80, h:75};
var right= {x:200, y:600, w:120, h:75};
  var mode='idle'
  var edit = 0;
  var words=''
  var kb=[]
  var klist=['1','2','3','4','5','6','7','8','9','0','q','w','e','r','t','y','u','i','o','p','a','s','d','f','g','h','j','k','l',' ',' ','z','x','c','v','b','n','m','del','back','space','ok']
  var size=32
  var y = 675-160*1.25
  var x=0
  var vkey=null
  for(let i = 0; i <klist.length;i++){
    
    if(klist[i]!='del'&&klist[i]!='back'&&klist[i]!='space'&&klist[i]!='ok'){
    vkey = {label:klist[i],x:x,y:y,w:size,h:size*1.25}
      x+=size;
    }else{
      if(klist[i]!='del'&&klist[i]!='back'&&klist[i]!='ok'){
      vkey = {label:klist[i],x:x,y:y,w:size*6,h:size*1.25}
        x+=size*6;
      }else{
      vkey = {label:klist[i],x:x,y:y,w:size*2,h:size*1.25}
        x+=size*2
      }
    }
    if(x>=320){
      x=0;
      y+=size*1.25
    }
    kb.push(vkey)
  }
  //foods
  var foods = []
  var currentFood=0
  if(localStorage.getItem("full_menu")!=null){
    foods = JSON.parse(localStorage.getItem("full_menu"))
  }else{
  let food = {description:"apple",kcal:120,protein:1,cholesterol:0,fiber:10}
    foods.push(food)
    localStorage.setItem("full_menu", JSON.stringify(foods));
  }
  function start(){
    
  }
  function loop(){
    if(keyboard_check(vk_a)){
      addFood();
    }
    if(mouse_down){
      if(mode!='input'){
        checkGui()
      }else{
        check_vkeys()
      }
      
      mouse_down=false;
    }
  }
  function checkGui(){
    if(inside(mouse_x, mouse_y, left.x, left.y, left.w, left.h, 0, 0, 0)){
      if(currentFood>0){
        currentFood--
      }else{
        currentFood=foods.length-1
      }
    }
    if(inside(mouse_x, mouse_y, center.x, center.y, center.w, center.h, 0, 0, 0)){
      addFood()
    }
    if(inside(mouse_x, mouse_y, right.x, right.y, right.w, right.h, 0, 0, 0)){
      if(currentFood<foods.length-1){
        currentFood++
      }else{
        currentFood=0
      }
    }
  }
  function addMacros(mx,my){
    //inside(px, py, rx, ry, width, height, angle, originX, originY)
    //draw_rectangle(x, y, w, h,outline,rot,ox,oy)
    let spacing=20
    if( inside(mx,my,160, spacing*2.5, foods[currentFood].description.length*30, 30,0,(foods[currentFood].description.length*30)/2,15)){
      edit=0;
    }
    if( inside(mx,my,160, spacing*6.25 , foods[currentFood].kcal.toString().length*30, 30,0,(foods[currentFood].kcal.toString().length*30)/2,15)){
      edit=1;
    }
    if( inside(mx,my,160, spacing*9.75, foods[currentFood].protein.toString().length*30, 30,0,(foods[currentFood].protein.toString().length*30)/2,15)){
      edit=2;
    }
    if(  inside(mx,my,160, spacing*13.5, foods[currentFood].cholesterol.toString().length*30, 30,0,(foods[currentFood].cholesterol.toString().length*30)/2,15)){
      edit=3;
    }
    if( inside(mx,my,160, spacing*17.25, foods[currentFood].fiber.toString().length*30, 30,0,(foods[currentFood].fiber.toString().length*30)/2,15)){
      edit=4;
    }
    
    
    
  }
  function draw(){
    draw_Gui()
    if(mode=='input'){
      draw_vkeys()
    }
    
    
    
  }
  function draw_vkeys(){
    draw_set_color(59,59,59);
    draw_rectangle(0, 675-160*1.25, 320, 160*1.25,0,0,0,0)
  //{label:klist[i],x:x,y:y,w:size*2,h:size}
    for(let i = 0; i < kb.length; i ++){
      draw_set_color(80,80,80);
      draw_set_linewidth(2)
      draw_rectangle(kb[i].x, kb[i].y, kb[i].w, kb[i].h,1,0,0,0)
      draw_set_color(200,200,200);
      draw_centered_text(kb[i].x+kb[i].w/2, kb[i].y+kb[i].h/2, kb[i].label, 20, 600)
    }
    draw_set_color(0,0,0);
    draw_set_linewidth(4)
    //draw_rectangle(0, 675-224*1.25, 320, 64,1,0,0,0)
    //words
    draw_centered_text(160, 675-224*1.25+32, words, 48, 700)
  }
  function check_vkeys(){
    for(let i = 0;i<kb.length;i++){
      if(inside(mouse_x, mouse_y, kb[i].x, kb[i].y, kb[i].w, kb[i].h, 0, 0, 0)){
        if(kb[i].label!='space' && kb[i].label!='del' && kb[i].label!='ok' && kb[i].label!='back'){
          words+=kb[i].label
          
        }else{
        if(kb[i].label=='space'){words+=' '}
        if(kb[i].label=='del'){words = words.substring(0, words.length - 1)}
        if(kb[i].label=='back'){mode='idle'}
        }
      }
    }
    // check macro text boxes for selection
    addMacros(mouse_x,mouse_y);
  }
  function draw_Gui(){
    //draw_rectangle(x, y, w, h,outline,rot,ox,oy)
    //\draw button rectangles
    draw_set_color(128,128,128)
    draw_rectangle(left.x, left.y, left.w, left.h, 0, 0, 0, 0)
    draw_rectangle(center.x, center.y, center.w, center.h, 0, 0, 0, 0)
    draw_rectangle(right.x, right.y, right.w, right.h, 0, 0, 0, 0)
    //draw button outline
    draw_set_color(0,0,0)
    draw_set_linewidth(4)
    draw_rectangle(left.x, left.y, left.w, left.h, 1, 0, 0, 0)
    draw_rectangle(center.x, center.y, center.w, center.h, 1, 0, 0, 0)
    draw_rectangle(right.x, right.y, right.w, right.h, 1, 0, 0, 0)
    //draw border rectangle
    draw_set_linewidth(12)
    draw_rectangle(0, 0, 320, 675,1,0,0,0)
    //draw button text
    //draw_centered_text(x, y, text, size, weight)
    draw_centered_text(left.x+left.w/2, left.y+left.h/2, "left", 20, 700)
    draw_centered_text(center.x+center.w/2, center.y+center.h/2, "ADD", 20, 700)
    draw_centered_text(right.x+right.w/2, right.y+right.h/2, "right", 20, 700)
    if(mode!='input'){
      draw_centered_text(160, 40, kcal+" / "+KCALS, 30, 700)
      draw_centered_text(160, 80, protien+" / "+PROTEIN, 30, 700)
      draw_centered_text(160, 120, cholesterol+" / "+CHOLESTEROL, 30, 700)
      draw_centered_text(160, 160, fiber+" / "+FIBER, 30, 700)
    }
    if(mode=='input'){
      let spacing=20
      draw_set_color(0,0,0);
      draw_set_linewidth(2)
      draw_centered_text(160, spacing, 'FOOD', 30, 700)
    if(edit==0){draw_set_color(255,0,0);}
      draw_centered_text(160, spacing*2.5, foods[currentFood].description, 30, 700)
      draw_rectangle(160, spacing*2.5, foods[currentFood].description.length*30, 30,1,0,(foods[currentFood].description.length*30)/2,15)
      draw_set_color(0,0,0);
      draw_centered_text(160, spacing*4.5, 'KCALS', 30, 700)
    if(edit==1){draw_set_color(255,0,0);}
      draw_centered_text(160, spacing*6.25, foods[currentFood].kcal, 30, 700)
      draw_rectangle(160, spacing*6.25 , foods[currentFood].kcal.toString().length*30, 30,1,0,(foods[currentFood].kcal.toString().length*30)/2,15)
      draw_set_color(0,0,0);
      draw_centered_text(160, spacing*8.15, 'PROTEIN', 30, 700)
    if(edit==2){draw_set_color(255,0,0);}
      draw_centered_text(160, spacing*9.75, foods[currentFood].protein, 30, 700)
      draw_rectangle(160, spacing*9.75, foods[currentFood].protein.toString().length*30, 30,1,0,(foods[currentFood].protein.toString().length*30)/2,15)
      draw_set_color(0,0,0);
      draw_centered_text(160, spacing*11.75, 'CHOLESTEROL', 30, 700)
    if(edit==3){draw_set_color(255,0,0);}
      draw_centered_text(160, spacing*13.5, foods[currentFood].cholesterol, 30, 700)
      draw_rectangle(160, spacing*13.5, foods[currentFood].cholesterol.toString().length*30, 30,1,0,(foods[currentFood].cholesterol.toString().length*30)/2,15)
      draw_set_color(0,0,0);
      draw_centered_text(160, spacing*15.5, 'FIBER', 30, 700)
    if(edit==4){draw_set_color(255,0,0);}
      draw_centered_text(160, spacing*17.25, foods[currentFood].fiber, 30, 700)
      draw_rectangle(160, spacing*17.25, foods[currentFood].fiber.toString().length*30, 30,1,0,(foods[currentFood].fiber.toString().length*30)/2,15)
    }
    /*
    draw_centered_text(160, 320, foods[currentFood].description, 20, 700)
    draw_centered_text(160, 340, foods[currentFood].kcal+":kcal", 20, 700)
    draw_centered_text(160, 360, foods[currentFood].protein+":protein", 20, 700)
    draw_centered_text(160, 380, foods[currentFood].cholesterol+":cholesterol", 20, 700)
    draw_centered_text(160, 400, foods[currentFood].fiber+":fiber", 20, 700)
    */
  }
  function addFood(){
    mode='input'
    /*
    let description = prompt("enter food description","")
    if(description=='delete'){
      if(foods.length>1){
        foods.splice(currentFood, 1);
      }
      localStorage.setItem("full_menu", JSON.stringify(foods));
      return
    }
    if(description=='reset'){
      foods = []
      currentFood=0
    let food = {description:"apple",kcal:120,protein:1,cholesterol:0,fiber:10}
      foods.push(food)
      localStorage.setItem("full_menu", JSON.stringify(foods));
      return;
    }
    
    if(description=='export'){
      menuExport(JSON.stringify(foods))
      return;
    }
    let kcal = prompt("enter food kcal","")
    let protein = prompt("enter food protein","")
    let cholesterol = prompt("enter food cholesterol","")
    let fiber = prompt("enter food fiber","")
    
  let food = {description:description,kcal:kcal,protein:protein,cholesterol:cholesterol,fiber:fiber}
    foods.push(food)
    localStorage.setItem("full_menu", JSON.stringify(foods));
    alert("new food added!!")
    */
  }
  /**
  * Triggers a file download containing the specified string content.
* @param {string} content - The string content to be written to the file.
* @param {string} [filename='download.txt'] - The desired filename for the downloaded file.
  */
  function menuExport(content, filename = 'download.txt') {
    // 1. Create a Blob (Binary Large Object) from the string content.
    // The type 'text/plain' ensures it's treated as a plain text file.
  const blob = new Blob([content], { type: 'text/plain' });
    
    // 2. Create a temporary URL for the Blob object.
    const url = URL.createObjectURL(blob);
    
    // 3. Create a temporary anchor (<a>) element to simulate a download link.
    const a = document.createElement('a');
    a.href = url;
    a.download = filename; // Set the desired filename
    
    // 4. Append the link to the document body (required for Firefox)
    // and then programmatically "click" it to start the download.
    document.body.appendChild(a);
    a.click();
    
    // 5. Clean up by removing the temporary link and revoking the object URL.
    // This frees up memory and resources.
    document.body.removeChild(a);
    URL.revokeObjectURL(url);
  }
  </script>
  <script type='text/javascript' src='engine.js'></script>
  </body>
  </html>
  
  
  
